<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Thank you · CBT</title>
<style>
:root{--muted:#6b7280;--accent:#0b5fff;--danger:#ef4444;--success:#059669;--bg:#f7fbff;--card-bg:#fff;--shadow:0 6px 18px rgba(2,6,23,0.06)}
body,html{margin:0;height:100%;font-family:Inter,system-ui,Arial;background:var(--bg);color:#0b2540}
.header{background:var(--card-bg);border-bottom:1px solid #eef4ff;padding:12px 20px;display:flex;justify-content:space-between;align-items:center}
.header a{color:var(--accent);text-decoration:none;margin-right:12px;font-size:14px}
.container{max-width:980px;margin:24px auto;padding:16px}
.card{background:var(--card-bg);padding:20px;border-radius:12px;box-shadow:var(--shadow);transition:opacity 0.3s ease;text-align:center}
@keyframes fadeIn{to{opacity:1}}
.card.fade-in{animation:fadeIn 0.3s forwards}
.small{font-size:13px;color:var(--muted)}
.success-banner{background:var(--success);color:#fff;padding:10px 14px;border-radius:8px;margin-bottom:12px;font-weight:600;display:inline-block}
.score{font-size:18px;font-weight:500;margin:12px 0;color:#0b2540}
.score strong{font-size:24px;color:var(--accent)}
.progress-bar{height:10px;background:#eef4ff;border-radius:5px;overflow:hidden;margin:12px 0;box-shadow:inset 0 1px 2px rgba(0,0,0,0.05)}
.progress-fill{height:100%;background:var(--accent);transition:width 0.5s ease}
button{background:var(--accent);color:#fff;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-size:14px}
button:hover{background:#0056b3;transform:translateY(-1px)}
button:active{transform:translateY(1px)}
button.secondary{background:#fff;border:1px solid var(--accent);color:var(--accent)}
button.secondary:hover{background:var(--accent);color:#fff}
.error-notice{background:#fef2f2;border:1px solid var(--danger);padding:12px;border-radius:8px;margin-bottom:16px}
.answer-item{margin:16px 0;padding:12px;border:1px solid #eef4ff;border-radius:8px}
.answer-item.correct{background:#ecfdf5;border-color:#10b981}
.answer-item.incorrect{background:#fef2f2;border-color:var(--danger)}
.answer-item .question{font-weight:500;margin-bottom:8px}
.answer-item .choice{margin:4px 0;font-size:14px}
.answer-item .correct-answer{font-weight:500;color:var(--success)}
.answer-item .your-answer{font-weight:500;color:var(--danger)}
.loading-spinner{display:inline-block;border:3px solid #e6eefc;border-top:3px solid var(--accent);border-radius:50%;width:24px;height:24px;animation:spin 1s linear infinite}
@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
@media (max-width:600px){.row{flex-direction:column;gap:8px}.buttons{justify-content:center}}
</style>
</head>
<body>
  {% extends "base.html" %}
  {% block title %}Thank you · CBT{% endblock %}
  {% block content %}
  <style>
:root{--muted:#6b7280;--accent:#0b5fff;--danger:#ef4444;--success:#059669;--bg:#f7fbff;--card-bg:#fff;--shadow:0 6px 18px rgba(2,6,23,0.06)}
.container{max-width:980px;margin:24px auto;padding:16px}
.card{background:var(--card-bg);padding:20px;border-radius:12px;box-shadow:var(--shadow);transition:opacity 0.3s ease;text-align:center}
.small{font-size:13px;color:var(--muted)}
.success-banner{background:var(--success);color:#fff;padding:10px 14px;border-radius:8px;margin-bottom:12px;font-weight:600;display:inline-block}
button{background:var(--accent);color:#fff;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-size:14px}
@media (max-width:600px){.container{padding:12px}}
</style>

<div class="container">
  <div class="card" id="resultsCard" style="opacity:1">
    <div class="success-banner" id="submittedMsg">Submitted successfully</div>

    <h2>Thank you for taking this test!</h2>

    <div style="margin:20px 0;text-align:center">
      <button id="viewScoreBtn" class="btn" style="min-width:150px">View My Score</button>
    </div>

    <div id="scorePanel" style="display:none">
      <div style="text-align:center;margin:20px 0">
        <div style="font-size:24px;font-weight:600;color:var(--accent)">
          Score: <span id="scoreDisplay">{{ score|default('') }}/{{ total|default('') }}</span>
        </div>
        <div style="margin-top:8px;color:#666">
          {% if name %}Submitted by: {{ name }}{% endif %}
        </div>
        {% if submitted_at %}
        <div style="margin-top:4px;color:#666;font-size:14px">
            Submitted on {{ submitted_at|datetime }}
        </div>
        {% endif %}
      </div>

      <div id="answers" style="margin-top:12px"></div>
    </div>
  </div>
</div>

<script id="token-data" type="application/json">{{ token|default('')|tojson|safe }}</script>
<script>
document.getElementById('viewScoreBtn').addEventListener('click', function() {
  const scorePanel = document.getElementById('scorePanel');
  scorePanel.style.display = 'block';
  this.style.display = 'none';
});

// slight visual tweak
setTimeout(()=>{
  const msg = document.getElementById('submittedMsg');
  if(msg) msg.style.opacity = '0.95';
},200);
</script>
{% endblock %}
</body>
</html>
